# 7.1. 存储类型

Proxmox VE 将存储分为两种基本类型：

**文件存储**

文件存储允许访问全功能（POSIX）文件系统。这类存储方案比块存储（如下）更加灵活，允许保存所有类型的数据。ZFS 大概是目前最先进的文件存储方案，并且完全支持快照和克隆功能。

**块存储**

可用于存储 raw 格式的虚拟机镜像。但不可用于存储其他文件（ISO，虚拟机备份，…）。大部分较新的块存储方案自带了快照和克隆功能。RADOS 和 GlusterFS 是分布式存储，并将数据分散在多个节点保存。

表 2.可用的存储类型

|名称 |PVE名称|级别|支持共享|支持快照|是否稳定|
|-----|-------|----|-------|------|--------|
|ZFS（本地）|zfspool|块|否|是|是|
|目录|dir|文件|否|否1|是|
|BTRFS|btrfs|文件|否|是|实验性|
|Proxmox Backup|pbs|均是|是|n/a|是|
|NFS|nfs|文件|是|否1|是|
|CIFS|cifs|文件|是|否1|否|
|GlusterFS|glusterfs|文件|是|否1|是|
|CephFS|cephfs|文件|是|是|是|
|LVM|lvm|块|否2|否|是|
|LVM-thin|lvmthin|块|否|是|是|
|iSCSI/kernel|iscsi|块|是|否|是|
|iSCSI/libiscsi|iscsidir ect|块|是|否|是|
|Ceph/RBD|rbd|块|是|是|是|
|ZFS over iSCSi|zsf|块|是|是|是|

1：在基于文件系统的存储上，可通过使用 qcow2 格式虚拟磁盘来实现快照。

2：可以在 iSCSI 存储上配置 LVM，从而获得共享 LVM 存

## 7.1.1. 精简置备

一些存储方案，以及 Qemu 镜像文件 qcow2，支持精简置备（thin provisioning）。在精简置备模式下，只有虚拟机实际写入的数据才会占用物理存储空间。

例如，你创建了一个带有 32GB 磁盘的虚拟机，安装操作系统后，虚拟机根目录下有 3GB数据。这时，薄模式存储上虚拟机磁盘仅使用 3GB 空间，而非你在虚拟机内查看磁盘容量时看到的 32GB。

通过这种方式，精简置备模式存储允许你分配远大于当前实际可用存储空间的虚拟磁盘镜像。你可以为你的虚拟机创建很大的虚拟磁盘，当虚拟磁盘占用空间变大时，再向你的存储中增加物理硬盘设备，而无需重新调整虚拟磁盘的容量。

具有"快照"功能的所有存储类型也支持精简置备。

**警告**

当薄模式存储空间耗尽时，会造成其上所有虚拟机 IO 错误，进而导致文件系统不一致，甚至数据被破坏。建议不要超配存储空间，或者随时监控剩余空间，避免出错


